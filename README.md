# Roadmap по настройке VPS / VDS для веб-проекта

Все описанные ниже действия необходимо выполнять на удалённом сервере, если не указано обратное

ВНИМАНИЕ! Не выполняйте в терминале непонятные вам команды, потратьте время, чтобы разобраться в том, что вы делаете. Бездумный копи-паст может привести к потере доступа / данных. Сделайте бэкап, если у вас его ещё нет. Будье осторожны при работе с любыми системными файлами, например, `sudoers`. Отредактировав его неверно, вы можете лишиться возможности выполнения команд через `sudo`. Это поправимо, если у вас есть `root` доступ или если в системе установлены определённые утилиты.

## Настройка ОС и веб-сервера

1. Изменить пароль пользователя root на собственный
2. Создать нового пользователя и выдать ему sudo права: впредь именно под этим пользователем будет осуществляться вход на сервер
3. В целях безопасности, изменить SSH порт по умолчанию (не обязательно)
4. В целях безопасности, разрешить вход на сервер по SSH только новому пользователю (не обязательно)  
Статья по теме: [Начальная настройка сервера Ubuntu 12.04](http://www.8host.com/blog/nachalnaya-nastrojka-servera-ubuntu-12-04/)
5. Настроить подключение через SSH ключ  
Статья по теме: [Ssh-copy-id for copying SSH keys to servers](https://www.ssh.com/ssh/copy-id)
6. Установить cURL (если не установлен "из коробки")
7. Установить Wget (если не установлен "из коробки")
8. Установить htop
9. Установить nginx
10. Настроить конфигурацию nginx для веб-проекта
11. Настроить защищённое соединение  
Статья по теме: [Let's Encrypt и nginx: настройка в Debian и Ubuntu](https://habr.com/ru/post/318952/)
12. Настроить редиректы с http:// на https:// и с www.host на host  
Материал по теме: [ssl - Remove "www" and redirect to "https" with nginx - Server Fault](https://serverfault.com/a/258424)

## Настройка third-party компонентов

Установка компонентов для приложения на PHP

1. Установить Git
2. Установить PHP 7.3
3. Установить Composer
4. Установить СУБД, которую будет использовать ваше веб-приложение (например, MySQL или PostgreSQL)
5. Создать нового пользователя (роль) в СУБД, который будет использоваться для подключения к БД
6. Создать новую БД, выдать новому пользователю права на неё

## Настройка автоматического развёртывания приложения (auto deployment)

Настройка для приложения на Laravel

1. Создать репозиторий на GitLab (если ещё не создан)
2. Залить в репозиторий веб-приложение (если ещё не залито)
3. Выполнить дальнейшую настройку по этой статье: [Test and deploy Laravel applications with GitLab CI/CD and Envoy](https://docs.gitlab.com/ee/ci/examples/laravel_with_gitlab_and_envoy/)
